<!doctype html>
<html style="font-size: 60px;">
<head>
    <meta charset="utf-8">
    <!-- uc强制竖屏 -->
    <meta name="screen-orientation" content="portrait">
    <!-- QQ强制竖屏 -->
    <meta name="x5-orientation" content="portrait">
    <meta name="viewport" content="width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>我的银行卡-麦买购</title>
    <!-- Bootstrap -->
    <link href="<%templateskin%>/css/animate.css" rel="stylesheet">
    <link href="<%templateskin%>/css/bootstrap.min.css" rel="stylesheet">
    <link href="<%templateskin%>/css/base.css" rel="stylesheet" type="text/css">
    <link href="<%templateskin%>/css/usercenter.css" rel="stylesheet" type="text/css">
    <link href="<%templateskin%>/css/city-picker.css" rel="stylesheet" type="text/css" />
    <link href="<%templateskin%>/css/easydropdown.css" rel="stylesheet" type="text/css" />
    <link href="<%templateskin%>/js/skin/layer.css" rel="stylesheet" type="text/css" />
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="<%templateskin%>/js/jquery.min.js"></script>
    <script src="<%templateskin%>/js/city-picker.data.js"></script>
    <script src="<%templateskin%>/js/city-picker.js"></script>
    <script src="<%templateskin%>/js/bootstrap.min.js"></script>
    <script src="<%templateskin%>/js/layer.js"></script>
    <script>
        $(function () {
            var $citypicker3 = $('#city-picker3');
            if ($citypicker3 != undefined) {
                var pp = "";
                var ct = "";
                $citypicker3.citypicker({
                    level: "city",
                    province: pp,
                    city: ct
                });
            }
        });
        function saveuserinfo(objuid) {
            var bnum = $("#bnum").val();
            var inum = $("#inum").val();
            var tname = $("#tname").val();
            var bname = $("#bname").val();
            var aliname = $("#alinickname").val();
            var pca = $("#city-picker3").val();
            if (pca != null) {
                var province = "";
                var city = "";
                if (pca != "") {
                    var arr = pca.split('/');
                    if (arr.length > 1) {
                        province = arr[0];
                        city = arr[1];
                    }
                    else {
                        layer.open({
                            content: "请选择开户行所在区域！",
                            time: 2000
                        });
                        return false;
                    }
                }
                aliname = province + city + aliname;
            }
            if (bnum != "" && inum != "" && tname != "" && bname != "" && aliname!="") {
                if (objuid * 1 > 0) {
                    var baseurl = '/api/appfun.ashx?action=cardno_save&uid=' + objuid + '&bnum=' + bnum + '&inum=' + inum + '&tname=' + tname + "&bname=" + bname + "&aliname=" + aliname;
                    $.ajax({
                        url: baseurl,
                        type: 'GET',
                        dataType: 'json',
                        timeout: '1000',
                        cache: 'false',
                        success: function (data) {
                            if (data.success == "true") {
                                layer.open({
                                    content: data.msg,
                                    time: 2000
                                });
                                setTimeout(function () {
                                    var turl = data.url;
                                    if (turl != "") {
                                        if (typeof (data.url) == "undefined") {
                                            location.href = $("#turl").val();
                                        } else {
                                            location.href = data.url;
                                        }
                                    }
                                }, 2500);
                            } else {
                                layer.open({
                                    content: data.msg,
                                    time: 2000
                                });
                            }
                        }
                    });
                }
                else {
                    return false;
                }
            }
            else {
                layer.open({
                    content: "信息填写完整后提交!",
                    time: 2000
                });
            }
        }
        function showbankname() {
            var cardno = $("#bnum").val();
            if (cardno != "") {
                var b = 0;
                var flag = cardno.substr(0, 6);
                if (flag == "436742" || flag == "436745" || flag == "436742" || flag == "622280") {
                    $("#bname").val("中国建设银行");
                    b = 1;
                }
                if (flag == "458123" || flag == "521899" || flag == "622260") {
                    $("#bname").val("交通银行");
                    b = 1;
                }
                if (flag == "622188") {
                    $("#bname").val("中国邮政储蓄");
                    b = 1;
                }
                if (flag == "622760" || flag == "409666" || flag == "438088" || flag == "622752") {
                    $("#bname").val("中国银行");
                    b = 1;
                }
                if (flag == "427020" || flag == "427030" || flag == "530990" || flag == "622230" || flag == "622235" || flag == "622210" || flag == "622215" || flag == "622200" || flag == "955880" || flag == "621226" || flag == "622208") {
                    $("#bname").val("中国工商银行");
                    b = 1;
                }
                if (flag == "622568" || flag == "520152" || flag == "520382" || flag == "911121" || flag == "548844") {
                    $("#bname").val("广东发展银行");
                    b = 1;
                }
                if (flag == "512431" || flag == "520194" || flag == "622318" || flag == "622718" || flag == "622282") {
                    $("#bname").val("宁波银行");
                    b = 1;
                }
                if (flag == "407405" || flag == "517636" || flag == "512466" || flag == "415599" || flag == "421870" || flag == "622622" || flag == "528948" || flag == "552288" || flag == "556610" || flag == "622600" || flag == "622601" || flag == "622602" || flag == "622603" || flag == "421869" || flag == "421871" || flag == "628258") {
                    $("#bname").val("中国民生银行");
                    b = 1;
                }
                if (flag == "406254" || flag == "622655" || flag == "622650" || flag == "622658" || flag == "356839" || flag == "486497" || flag == "481699" || flag == "543159" || flag == "425862" || flag == "406252" || flag == "356837" || flag == "356838" || flag == "356840" || flag == "622161" || flag == "628201" || flag == "628202") {
                    $("#bname").val("光大银行");
                    b = 1;
                }
                if (flag == "498451" || flag == "622517" || flag == "622518" || flag == "515672" || flag == "517650" || flag == "525998" || flag == "356850" || flag == "356851" || flag == "356852") {
                    $("#bname").val("浦东发展银行");
                    b = 1;
                }
                if (flag == "622155" || flag == "622156" || flag == "528020" || flag == "526855") {
                    $("#bname").val("平安银行");
                    b = 1;
                }
                if (flag == "539867" || flag == "528709" || flag == "523959" || flag == "622637" || flag == "622636" || flag == "528708" || flag == "539868") {
                    $("#bname").val("华夏银行");
                    b = 1;
                }
                if (flag == "552599" || flag == "404119" || flag == "404121" || flag == "519412" || flag == "403361" || flag == "558730" || flag == "520083" || flag == "520082" || flag == "519413" || flag == "404120" || flag == "404118" || flag == "404117" || flag == "622836" || flag == "622837" || flag == "622848") {
                    $("#bname").val("农业银行");
                    b = 1;
                }
                var flag2 = cardno.substr(0, 5);
                if (flag2 == "49102" || flag2 == "53591") {
                    $("#bname").val("农业银行");
                    b = 1;
                }

                if (flag == "451289" || flag == "622902" || flag == "622901" || flag == "527414" || flag == "524070" || flag == "486494" || flag == "486493" || flag == "451290" || flag == "523036" || flag == "486861" || flag == "622922") {
                    $("#bname").val("兴业银行");
                    b = 1;
                }

                if (flag == "518710" || flag == "518718" || flag == "622588" || flag == "622575" || flag == "545947" || flag == "521302" || flag == "439229" || flag == "552534" || flag == "622577" || flag == "622579" || flag == "439227" || flag == "479229" || flag == "356890" || flag == "356889" || flag == "356885" || flag == "439188" || flag == "545948" || flag == "545623" || flag == "552580" || flag == "552581" || flag == "552582" || flag == "552583" || flag == "552584" || flag == "552585" || flag == "552586" || flag == "552588" || flag == "552589" || flag == "645621" || flag == "545619" || flag == "356886" || flag == "622578" || flag == "622576" || flag == "622581" || flag == "439228" || flag == "439225" || flag == "439226" || flag == "628262" || flag == "628362") {
                    $("#bname").val("招商银行");
                    b = 1;
                }

                if (flag == "376968" || flag == "376966" || flag == "622918" || flag == "622916" || flag == "518212" || flag == "622690" || flag == "520108" || flag == "376969" || flag == "622919" || flag == "556617" || flag == "622680" || flag == "403391" || flag == "558916" || flag == "514906" || flag == "400360" || flag == "433669" || flag == "433667" || flag == "433666" || flag == "404173" || flag == "404172" || flag == "404159" || flag == "404158" || flag == "403393" || flag == "403392" || flag == "622689" || flag == "622688" || flag == "433668" || flag == "404157" || flag == "404171" || flag == "404174" || flag == "628209" || flag == "628208" || flag == "628206") {
                    $("#bname").val("中信银行");
                    b = 1;
                }
            } else {
                layer.open({
                    content: "请先输入银行卡号!",
                    time: 2000
                });
            }
        }
    </script>
</head>
<body>
    <div id="pageContainer">
        <div class="top-bar">
            <a href="<%linkurl("usercenter")%>" class="back"></a><span class="title">我的银行卡</span>
        </div>
        <div class="common-wrapper">
            <div class="uc-form">
                <form class="form-inline">
                <div class="item item-tips">
                    请如实填写身份信息，提交后无法修改！</div>
                <div class="item item-input">
                    <label>
                        银行卡号：</label>
                    <%if({uinfo}!=null)%>
                    <%if({uinfo.cardno}!="")%>
                    <input class="txt-input" id="bnum" type="num" placeholder="请输入银行卡号" value="{uinfo.cardno}"
                        readonly="readonly">
                    <%else%>
                    <input class="txt-input" id="bnum" type="num" placeholder="请输入银行卡号" value="">
                    <%/if%>
                    <%else%>
                    <input class="txt-input" id="bnum" type="num" placeholder="请输入银行卡号" value="">
                    <%/if%>
                </div>
                <div class="item item-input">
                    <label>
                        所属银行：</label>
                    <%if({uinfo}!=null)%>
                    <%if({uinfo.bankname}!="")%>
                    <input class="txt-input" id="bname" type="text" placeholder="请输入银行卡所属银行" value="{uinfo.bankname}"
                        readonly="readonly">
                    <%else%>
                    <input class="txt-input" id="bname" type="text" placeholder="请输入银行卡所属银行" value=""
                        onfocus="showbankname()">
                    <%/if%>
                    <%else%>
                    <input class="txt-input" id="bname" type="text" placeholder="请输入银行卡所属银行" onfocus="showbankname()">
                    <%/if%>
                </div>
                <%if({uinfo}!=null)%>
                <%if({uinfo.alipaynickname}=="")%>
                <div class="item item-input">
                    <label>
                        开户区域：</label>
                    <div id="distpicker" style="padding-left: 95px;">
                        <div style="position: relative;">
                            <input id="city-picker3" name="city-picker3" class="txt-input form-control" readonly
                                type="text" data-toggle="city-picker3">
                        </div>
                    </div>
                </div>
                <%/if%>
                <%/if%>
                <div class="item item-input">
                    <label>
                        　开户行：</label>
                    <%if({uinfo}!=null)%>
                    <%if({uinfo.alipaynickname}!="")%>
                    <input class="txt-input" id="alinickname" type="text" placeholder="请输入银行卡开户行名称" value="{uinfo.alipaynickname}"
                        readonly="readonly">
                    <%else%>
                    <input class="txt-input" id="alinickname" type="text" placeholder="请输入银行卡开户行名称" value="">
                    <%/if%>
                    <%else%>
                    <input class="txt-input" id="alinickname" type="text" placeholder="请输入银行卡开户行名称">
                    <%/if%>
                </div>
                <div class="item item-input">
                    <label>
                        身份证号：</label>
                    <%if({uinfo}!=null)%>
                    <%if({uinfo.identyno}!="")%>
                    <input class="txt-input" id="inum" type="text" placeholder="请输入银行卡绑定身份证号码" value="{uinfo.identyno}"
                        readonly="readonly">
                    <%else%>
                    <input class="txt-input" id="inum" type="text" placeholder="请输入银行卡绑定身份证号码" value="">
                    <%/if%>
                    <%else%>
                    <input class="txt-input" id="inum" type="text" placeholder="请输入银行卡绑定身份证号码">
                    <%/if%>
                </div>
                <div class="item item-input">
                    <label>
                        手机号码：</label>
                    <input class="txt-input" type="num" value="{userModel.mobile}" readonly="readonly">
                </div>
                <div class="item item-input">
                    <label>
                        真实姓名：</label>
                    <%if({uinfo}!=null)%>
                    <%if({uinfo.identyno}!="")%>
                    <input class="txt-input" id="tname" type="text" placeholder="请输入银行卡持有人真实姓名" value="{uinfo.truename}"
                        readonly="readonly">
                    <%else%>
                    <input class="txt-input" id="tname" type="text" placeholder="请输入银行卡持有人真实姓名">
                    <%/if%>
                    <%else%>
                    <input class="txt-input" id="tname" type="text" placeholder="请输入银行卡持有人真实姓名">
                    <%/if%>
                </div>
                <div class="item item-input" style="border: none">
                    <a href="<%linkurl("workflow")%>" class="btn-workorder">提交工单</a>
                    <span class="fr">账号信息有误？请客服帮忙！</span>
                </div>
                <%if({uinfo}==null)%>
                <div class="item item-btns">
                    <a class="btn-confirm" href="javascript:;" onclick="saveuserinfo({userModel.id})">立即绑定</a>
                </div>
                <%else if({uinfo.cardno}=="" || {uinfo.alipaynickname}=="") %>
                <div class="item item-btns">
                    <a class="btn-confirm" href="javascript:;" onclick="saveuserinfo({userModel.id})">立即绑定</a>
                </div>
                <%/if%>
                </form>
                <input type="hidden" id="turl" value="<%linkurl("userbankcard")%>" />
            </div>
        </div>
    </div>
</body>
</html>
